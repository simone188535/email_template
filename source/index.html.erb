<html>
<head>
	
	<style>
	  ul, li {list-style: none;}
	  ul {margin: 0 0 1em 0; padding:0 0 0 0.5em;}
	  li {margin: 0 0 0.2em 0; padding:0 0 0 0.3em;}
	  h1,h2,h3,h4,h5,h6 {margin-bottom:0;}
	  .welcome {color: #333;}
	  h2 {color:#555; margin: 0.2em 0 0 0; font-size:18px;}
	  p {margin:0;}
	</style>
	
</head>
 <body>
 <div class="welcome">
<h1>Email Proofs</h1>
 
<br/>
<hr/>
<%  directories = Dir.entries("./build") 
    directories.reject! {|item| item =~ /\.\/build\/index.html|snippets|examples|content_template|\.|\.\.|images|index\.html|javascripts|stylesheets/i }
    directories.each do |directory_name| 
%>
<h2><%= directory_name %></h2>
<br/>
    <ul>
    <%     
        files_html = Dir.glob("./build/"+directory_name+"/**/*.html")
        files_txt = Dir.glob("./build/"+directory_name+"/**/*.txt")
		
        files_html.reject! {|item| item =~ /\.\/build\/index.html|snippets|examples|content_template/i }
        files_html.each do |file_name| 
	        file_contents = IO.read(file_name)
	        file_title = /(\<title\>)(.*)(\<\/title\>)/.match(file_contents)
			file_extension = (file_name.last(file_name.length-file_name.rindex('.')-1)).upcase
			txt_file_name = file_name.first(file_name.rindex('.'))+".txt"
			has_text = files_txt.include?(txt_file_name)
			if file_title==nil
				file_title = file_contents.lines[0]
			 else
				file_title = file_title[2]
			end
	    %>
	        <li><%= file_title %> - <a href="<%= file_name[('./build/').length,file_name.length] %>">HTML</a> - 
		<%
			if has_text==true
		%>
		<a href="<%= txt_file_name[('./build/').length,txt_file_name.length] %>">TXT</a>
		<%
			end
		%>
			</li>
    <% end %>
    </ul>
<hr/>
<br/>
 <% end %>
 </div><!-- .welcome -->
</body>
